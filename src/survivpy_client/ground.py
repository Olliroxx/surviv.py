import arcade

from survivpy_client import LevelLayer, num_to_colour
from survivpy_net.core import River
from survivpy_net.custom_types import Rect, Point
from arcade import gui

GRID_INTERVAL = 16
GRID_LINE_THICKNESS = 1
LINE_COLOUR = (0, 0, 0, 127)


class Ground(LevelLayer):
    """
    Water/sand/grass floors, not for buildings
    """

    # noinspection PyMissingConstructor
    def __init__(self, level=1):
        self.name = "ground"
        self.source = "main"
        self.level = level
        self.loader = None

        self.background_rect = None
        self.base_shore_poly = None  # Sand poly w/o rivers
        self.base_grass_poly = None
        self.overwrite_shore_polys = arcade.ShapeElementList()
        self.overwrite_river_polys = arcade.ShapeElementList()
        self.grid = arcade.ShapeElementList()

        self.master_list = arcade.ShapeElementList()

    def first_frame(self, state):
        colours = state.map.map_def["biome"]["colors"]

        self.background_rect = arcade.create_rectangle(state.map.width / 2, state.map.height / 2, state.map.width / 2,
                                                       state.map.height / 2, num_to_colour(colours["water"]))
        self.base_shore_poly = arcade.create_polygon(state.map.terrain["shore"], num_to_colour(colours["beach"]))
        self.base_grass_poly = arcade.create_polygon(state.map.terrain["grass"], num_to_colour(colours["grass"]))
        self.make_overwrite_polys(state.map.terrain["rivers"], num_to_colour(colours["water"]),
                                  num_to_colour(colours["riverbank"]))
        self.make_grid(state.map.width, state.map.height)

        self.merge_lists()

    def make_grid(self, width, height):
        for x_mult in range(1, width // GRID_INTERVAL):
            line = arcade.create_line(x_mult * GRID_INTERVAL, 0, x_mult * GRID_INTERVAL, height, LINE_COLOUR,
                                      GRID_LINE_THICKNESS)
            self.grid.append(line)

        for y_mult in range(1, height // GRID_INTERVAL):
            line = arcade.create_line(0, y_mult * GRID_INTERVAL, width, y_mult * GRID_INTERVAL, LINE_COLOUR,
                                      GRID_LINE_THICKNESS)
            self.grid.append(line)

    def make_overwrite_polys(self, river_list: list[River], water_colour, shore_colour):
        for river in river_list:
            water_poly = arcade.create_polygon(river.water_poly, water_colour)
            self.overwrite_river_polys.append(water_poly)
            shore_poly = arcade.create_polygon(river.shore_poly, shore_colour)
            self.overwrite_shore_polys.append(shore_poly)
            for item in river.water_poly:
                print(str(item)[1:-1])

    def merge_lists(self):
        self.master_list.append(self.background_rect)
        self.master_list.append(self.base_shore_poly)
        self.master_list.append(self.base_grass_poly)
        for poly in self.overwrite_shore_polys:
            self.master_list.append(poly)
        for poly in self.overwrite_river_polys:
            self.master_list.append(poly)
        for poly in self.grid:
            self.master_list.append(poly)

    def render(self, state, surface: gui.surface.Surface, layer):
        if layer == 0:
            return
        else:
            self.master_list.draw()


class DummyMap:
    def __init__(self):
        self.height = 720
        self.width = 720
        self.map_def = {
            "biome": {
                "colors": {
                    'background': 2118510,
                    'water': 3310251,
                    'waterRipple': 11792639,
                    'beach': 13480795,
                    'riverbank': 9461284,
                    'grass': 8433481,
                    'underground': 1772803,
                    'playerSubmerge': 2854052,
                    'playerGhillie': 8630096
                }
            }
        }
        self.terrain = {
            "shore": [
                (48, 48),
                (57.6, 46.504359302811494),
                (67.2, 50.76680235274453),
                (76.8, 49.64714257728641),
                (86.4, 47.525296452699834),
                (96.0, 49.65748052609036),
                (105.6, 47.275202000641826),
                (115.2, 46.32002478713171),
                (124.8, 48.65659732262446),
                (134.39999999999998, 49.431201349213346),
                (144.0, 48.201076228730884),
                (153.6, 49.48817627992862),
                (163.2, 45.77873676027112),
                (172.8, 47.22872987679612),
                (182.4, 45.2630393124479),
                (192.0, 49.901724311943035),
                (201.6, 48.28051082663262),
                (211.2, 46.54546321441674),
                (220.79999999999998, 45.6002447021195),
                (230.4, 47.31270852233875),
                (240.0, 46.692134947372665),
                (249.6, 50.71206049235168),
                (259.2, 47.60069495467501),
                (268.79999999999995, 50.880103222969964),
                (278.4, 45.89486845624394),
                (288.0, 49.05414409192937),
                (297.6, 46.99975305702526),
                (307.2, 48.84962942351104),
                (316.8, 47.72172095008275),
                (326.4, 50.96400804070942),
                (336.0, 46.08314020330233),
                (345.59999999999997, 45.33739690218931),
                (355.2, 45.62973509571968),
                (364.8, 50.957753760720486),
                (374.4, 48.967456429250284),
                (384.0, 48.04020640954385),
                (393.59999999999997, 45.74912520346657),
                (403.2, 47.54729466258888),
                (412.8, 47.38139413128672),
                (422.4, 49.091164535885284),
                (432.0, 45.20235462403035),
                (441.59999999999997, 49.97416607801531),
                (451.2, 47.80927320328042),
                (460.8, 46.45472753395081),
                (470.4, 50.60566311124976),
                (480.0, 47.37991077470589),
                (489.59999999999997, 48.16039048189315),
                (499.2, 49.68282917825637),
                (508.79999999999995, 47.30999895479064),
                (518.4, 49.15243316635137),
                (528.0, 48.94422686749335),
                (537.5999999999999, 47.62096196069427),
                (547.2, 49.507673388583434),
                (556.8, 49.466641921767334),
                (566.4, 49.85077914355825),
                (576.0, 50.04506578345088),
                (585.6, 45.42062245887733),
                (595.1999999999999, 46.40166635131541),
                (604.8, 46.80636655809654),
                (614.4, 50.60274192858615),
                (624.0, 46.283593747431226),
                (633.6, 48.3601130765677),
                (643.1999999999999, 46.42047787337586),
                (652.8, 50.971617828110055),
                (662.4, 47.98083704569416),
                (672, 48),
                (673.9282269817443, 57.6),
                (673.7108821760448, 67.2),
                (674.7967327850855, 76.8),
                (672.6879189329632, 86.4),
                (671.8535063112404, 96.0),
                (669.8805730170014, 105.6),
                (672.790696742847, 115.2),
                (671.240157028772, 124.8),
                (669.3191825711723, 134.39999999999998),
                (669.5014736934106, 144.0),
                (673.2683651523051, 153.6),
                (671.4131147928597, 163.2),
                (672.2203235929926, 172.8),
                (672.9786274274711, 182.4),
                (673.7911735078279, 192.0),
                (674.2531460631886, 201.6),
                (674.6258840112137, 211.2),
                (669.2325764672051, 220.79999999999998),
                (671.9126843162405, 230.4),
                (674.4853030552554, 240.0),
                (670.4884496766555, 249.6),
                (671.3737155480188, 259.2),
                (670.0372155518444, 268.79999999999995),
                (671.481779849381, 278.4),
                (674.2739285478713, 288.0),
                (669.9171040723645, 297.6),
                (674.7681442311816, 307.2),
                (672.2000934701414, 316.8),
                (674.9709526654198, 326.4),
                (672.8014477099299, 336.0),
                (671.9316607913615, 345.59999999999997),
                (669.4229204135122, 355.2),
                (673.0233899001141, 364.8),
                (670.114051217732, 374.4),
                (672.8588164224564, 384.0),
                (670.1276122234425, 393.59999999999997),
                (672.7786393974808, 403.2),
                (672.5923534601891, 412.8),
                (673.6846053985341, 422.4),
                (671.1629331634207, 432.0),
                (673.4176776122384, 441.59999999999997),
                (672.9076288910153, 451.2),
                (674.518771293349, 460.8),
                (674.989127316507, 470.4),
                (672.2628085349047, 480.0),
                (673.023046144295, 489.59999999999997),
                (670.3365471667314, 499.2),
                (674.3482312557046, 508.79999999999995),
                (670.7227146279638, 518.4),
                (672.6647521879826, 528.0),
                (672.4900234227488, 537.5999999999999),
                (669.8236661389581, 547.2),
                (670.3567974676176, 556.8),
                (672.6950382505055, 566.4),
                (671.5078762455414, 576.0),
                (674.8760588149894, 585.6),
                (673.9205035273546, 595.1999999999999),
                (669.9027842501657, 604.8),
                (674.0948925349372, 614.4),
                (672.8588346894173, 624.0),
                (670.4346250367512, 633.6),
                (672.7429926776061, 643.1999999999999),
                (673.4779325269526, 652.8),
                (671.6119804916028, 662.4),
                (672, 672),
                (662.4, 672.5561223679949),
                (652.8, 670.7486388905666),
                (643.2, 670.373833752877),
                (633.6, 671.0238846037648),
                (624.0, 670.4285354751295),
                (614.4, 672.3957305016908),
                (604.8, 669.0425419165019),
                (595.2, 670.0019906484531),
                (585.6, 673.4568285515796),
                (576.0, 670.9174663992214),
                (566.4, 669.8577717146173),
                (556.8, 673.5692075745059),
                (547.2, 669.6717047210185),
                (537.6, 672.3412461585092),
                (528.0, 671.3241860635226),
                (518.4, 671.5951696236596),
                (508.8, 672.0158648458383),
                (499.20000000000005, 674.640464004893),
                (489.6, 674.2785302378603),
                (480.0, 669.2577077179485),
                (470.4, 674.2936155597184),
                (460.8, 670.7967121870241),
                (451.20000000000005, 674.3417273151417),
                (441.6, 669.4109855864248),
                (432.0, 670.4347510419017),
                (422.4, 674.8607612409912),
                (412.8, 674.8141773388787),
                (403.2, 671.8785345344238),
                (393.6, 670.5299200618314),
                (384.0, 672.3664791990847),
                (374.40000000000003, 669.4158990161568),
                (364.8, 669.0147645464235),
                (355.2, 671.1477317410278),
                (345.6, 669.9273714539257),
                (336.0, 673.3320261288118),
                (326.40000000000003, 673.363146939484),
                (316.8, 674.4106119076771),
                (307.2, 669.1543323286596),
                (297.6, 670.86344778252),
                (288.0, 673.9668808127599),
                (278.40000000000003, 669.3658200559978),
                (268.8, 673.337681155809),
                (259.2, 672.4071856827509),
                (249.60000000000002, 669.5697699936898),
                (240.0, 669.1242839433831),
                (230.40000000000003, 669.8402364406923),
                (220.8, 672.8538587139238),
                (211.20000000000005, 670.8034049187803),
                (201.60000000000002, 672.8264699400526),
                (192.0, 672.4802824638226),
                (182.40000000000003, 674.1073694672004),
                (172.8, 672.5586352374212),
                (163.20000000000005, 670.982435338191),
                (153.60000000000002, 669.7907289754556),
                (144.0, 674.7818904825402),
                (134.39999999999998, 669.2333400529965),
                (124.80000000000007, 672.7462707114156),
                (115.20000000000005, 674.5718467615413),
                (105.60000000000002, 673.028521225801),
                (96.0, 672.3562420370785),
                (86.39999999999998, 671.3599171779863),
                (76.80000000000007, 672.1280104159973),
                (67.20000000000005, 669.4710616676467),
                (57.60000000000002, 672.1334481393609),
                (48, 672),
                (46.862878237787115, 662.4),
                (46.39454248798757, 652.8),
                (47.07559560708496, 643.2),
                (45.53536827700928, 633.6),
                (48.93463169500913, 624.0),
                (48.35489801846207, 614.4),
                (48.77099629201507, 604.8),
                (46.13467989728538, 595.2),
                (47.56503367543455, 585.6),
                (45.5209830284682, 576.0),
                (47.16175946507685, 566.4),
                (47.69132954659468, 556.8),
                (50.175689616788034, 547.2),
                (50.81538935648994, 537.6),
                (50.24891452642573, 528.0),
                (45.506445637208614, 518.4),
                (48.83182456522799, 508.8),
                (48.47546778687996, 499.20000000000005),
                (47.18709409152488, 489.6),
                (47.490396258649604, 480.0),
                (45.08991912384048, 470.4),
                (50.27071438695803, 460.8),
                (45.89670160361412, 451.20000000000005),
                (49.86385194252424, 441.6),
                (47.75959800498541, 432.0),
                (45.56366978984497, 422.4),
                (50.598157924412824, 412.8),
                (47.24023560632031, 403.2),
                (46.63983542548485, 393.6),
                (47.713996123855, 384.0),
                (47.13285363099205, 374.40000000000003),
                (47.87097608338621, 364.8),
                (45.495033472075605, 355.2),
                (49.027565174748915, 345.6),
                (50.28789200507472, 336.0),
                (46.600929290801716, 326.40000000000003),
                (47.818590504498495, 316.8),
                (47.05060910622152, 307.2),
                (45.58724826508539, 297.6),
                (50.88159129018038, 288.0),
                (46.904814061664425, 278.40000000000003),
                (49.20993439397306, 268.8),
                (49.367359505206046, 259.2),
                (49.21120399805308, 249.60000000000002),
                (46.70559527804404, 240.0),
                (48.93983808622688, 230.40000000000003),
                (45.858715215166434, 220.8),
                (47.42662130222964, 211.20000000000005),
                (47.22422657358657, 201.60000000000002),
                (47.57602226947249, 192.0),
                (50.20628302414263, 182.40000000000003),
                (48.99878676515016, 172.8),
                (46.609161878753994, 163.20000000000005),
                (48.18369621838615, 153.60000000000002),
                (45.382342416039826, 144.0),
                (45.02898638138035, 134.39999999999998),
                (46.174111859488356, 124.80000000000007),
                (50.29802242075001, 115.20000000000005),
                (48.86282554541846, 105.60000000000002),
                (47.508941848068005, 96.0),
                (50.78564047896566, 86.39999999999998),
                (48.25952997582943, 76.80000000000007),
                (47.92030376518159, 67.20000000000005),
                (46.545381407041745, 57.60000000000002)
            ],
            "grass": [
                (61.77694238371495, 61.77694238371495),
                (71.3712881826484, 60.78094267597611),
                (78.63584012313842, 62.84447109953714),
                (89.40790919792175, 63.46388214544011),
                (96.96312577406756, 59.589293509661104),
                (108.58321828505036, 64.44955501727483),
                (117.42041602247055, 61.805615573344184),
                (126.31551412226862, 60.56313832614931),
                (135.7331552218299, 63.129240812269146),
                (145.7631366399888, 65.07409006900973),
                (154.27938115998663, 63.03950207464984),
                (163.52580923118714, 64.42073987621464),
                (172.78659957315193, 61.08520743125308),
                (182.6292403622835, 63.651293939069994),
                (191.73396121300965, 61.80438268721227),
                (200.32905627374538, 65.27568852978371),
                (209.58627068837347, 63.9969011004964),
                (218.23955942530836, 61.37464223884294),
                (228.43469242312338, 62.84410554697995),
                (236.96089625718892, 63.1422523520172),
                (246.3058640008555, 63.15610817587481),
                (256.2923489159854, 69.46081779933861),
                (265.09291263881596, 65.86400659216423),
                (274.06155023715957, 68.71398333478949),
                (283.12873031291497, 64.09730052699273),
                (292.30218228757775, 67.6339462264211),
                (300.88640501342616, 63.48445787684916),
                (310.31142453396535, 67.1852524682856),
                (319.0284674397725, 63.83056301052086),
                (328.5271181662276, 70.5281768655537),
                (337.2779601351704, 62.79869156072172),
                (346.4289986559597, 63.4523187805829),
                (355.4463284297859, 61.76272128848149),
                (364.5095355265584, 69.65896070345114),
                (373.6094022769826, 66.04395786892586),
                (382.7584930140702, 64.17771737086716),
                (391.834663135155, 62.259799432279195),
                (400.9309796822546, 63.958441346503164),
                (409.8053561752676, 65.11210203964274),
                (419.15920142395385, 65.23848683159456),
                (428.43040400163335, 60.80930483554857),
                (436.6504063355889, 68.77933646262335),
                (445.90879579388434, 65.9218267859242),
                (455.53437647349404, 62.83380851928761),
                (463.9838805515086, 68.58674121057042),
                (473.18743627359004, 65.12777977473331),
                (483.1030645590015, 63.79312050492801),
                (491.67470368643956, 66.45889714965985),
                (500.48564955055434, 64.78186891935638),
                (509.60977287958355, 66.40256392579954),
                (519.1656568606318, 65.30121160162447),
                (528.7243415238408, 63.23227759553653),
                (538.7087724867938, 63.591332503766594),
                (547.4654022323101, 64.19582886846607),
                (557.325678784709, 63.48640731566866),
                (565.200118953695, 65.54264179851585),
                (574.2833855757319, 61.200646933430264),
                (584.7951872301687, 60.27467632812507),
                (593.0032823821534, 61.898919063903186),
                (603.6965021431864, 63.62016680543901),
                (612.6148335790953, 59.81281152831632),
                (622.0723363451551, 61.49052169457662),
                (630.2057856480536, 60.808611796025005),
                (639.9985030179729, 64.48263525206555),
                (650.8257104027808, 59.92329786551903),
                (658.2874710966557, 61.71252890334422),
                (661.8199750043447, 69.26360678416651),
                (660.2919542776581, 79.72446858519483),
                (660.3492387808327, 89.79737219572007),
                (658.2385616449484, 99.04309848455772),
                (657.4744495161071, 108.17260962949237),
                (656.9053998627661, 116.25211677615029),
                (659.5678866888778, 125.54859391573535),
                (657.2411607193889, 135.37885320261728),
                (654.6804139404344, 145.07669381395243),
                (656.3106006719253, 153.20586431670193),
                (657.4341193399645, 164.03255144539787),
                (657.7876301361164, 171.81073363024777),
                (655.2974903746187, 182.94653479960292),
                (658.7796466084349, 190.45722427179226),
                (657.234294506578, 200.86435281501184),
                (656.5903184139669, 210.50298771766043),
                (658.0587207827986, 219.03531811483222),
                (652.240565408796, 228.44889639491586),
                (655.945316425959, 237.03445567504525),
                (656.7356203349882, 246.77285045036848),
                (652.7495989688044, 255.9073815473207),
                (653.5904754512355, 264.9569104656148),
                (652.6745231895912, 273.90737893390957),
                (653.9711698169143, 282.9873173684195),
                (658.4746615840788, 291.61960416713276),
                (652.5042049084061, 301.105985612131),
                (655.264452732835, 310.4715982540989),
                (654.097551857548, 319.30489930663276),
                (658.7204536879962, 328.13354641442584),
                (653.071280703029, 337.51381654922756),
                (652.4091307889917, 346.5012372495979),
                (652.8243278343066, 355.4574897951118),
                (654.9153332831714, 364.5223253131689),
                (652.2461484676717, 373.57031234608513),
                (655.4881119723723, 382.6674599374592),
                (651.0495368728635, 391.5330336722239),
                (655.3397647663514, 400.79139759186876),
                (655.2976810020044, 409.87875545999736),
                (657.0915853977796, 419.0992181629965),
                (652.4716376347639, 427.67502059328996),
                (657.1463035279359, 437.36365910374144),
                (655.9140086159274, 446.24704255827584),
                (655.7301782776033, 454.7784510533371),
                (658.9518813340363, 464.779133109932),
                (655.5642723711422, 473.5828914463007),
                (656.082160267392, 482.5860154493719),
                (655.4591662508618, 492.5268206970917),
                (658.3120411928071, 501.20910288622514),
                (653.7951025175606, 509.7706541811779),
                (657.4491630264719, 519.8244094953277),
                (656.5873578743528, 528.5619085740401),
                (653.9288451460774, 537.596116194259),
                (655.2934009159073, 547.2481665439085),
                (656.5622858227453, 555.7512857776076),
                (657.956799536903, 566.6036643299551),
                (661.2129874081402, 575.8107866790969),
                (658.1284014915309, 583.3680159241268),
                (655.4477859269066, 593.3816334367705),
                (659.7372361079158, 602.7710691200496),
                (657.971993631653, 611.4380212304015),
                (656.0317313978694, 620.9060819194008),
                (658.1721461012331, 630.0055756738165),
                (660.8851979700312, 641.0379194970939),
                (659.2051527992511, 650.3599472130428),
                (657.9812865990107, 657.9812865990107),
                (649.5948853457261, 659.3209471602653),
                (640.4864716404508, 657.6802912892335),
                (632.2183106055274, 658.3384204815289),
                (621.9384524461044, 657.7672332123024),
                (611.9728063357845, 656.2861714029394),
                (602.883832819339, 658.2542153327356),
                (594.3618013156663, 655.8650604849826),
                (583.9444939171311, 655.1668320963904),
                (574.3850141338472, 657.8743201213712),
                (566.4582146354551, 657.1827083877886),
                (555.9801325883092, 654.2149572875425),
                (548.2020268397986, 659.8697175816643),
                (537.9289719061923, 654.3352994094486),
                (527.7511345191348, 655.0202612624452),
                (520.3385519776142, 657.1266023156818),
                (510.7066459868864, 656.4612558061659),
                (500.76186476069773, 655.1608532971911),
                (491.4893742572842, 657.2117652875355),
                (482.5783868995891, 657.2511980997734),
                (474.19188021058375, 654.2893259493974),
                (464.83856806444936, 658.4609837597775),
                (455.196333838002, 653.5189242967199),
                (445.9871336316586, 656.3743872001476),
                (437.0460600963355, 652.1433503671334),
                (428.3671249675967, 654.7712697050898),
                (419.2833266619665, 659.1345090013642),
                (409.53633533420594, 655.3549366784256),
                (400.53476198956025, 652.6370871992065),
                (391.5946329720884, 651.996394381116),
                (382.5373067838495, 653.3291321125298),
                (373.483602751159, 649.7250741129577),
                (364.5220372314348, 651.1200563212459),
                (355.45670806772023, 654.5072873679491),
                (346.39949627782914, 652.7200256292879),
                (337.51632673380135, 653.5356208048422),
                (328.18880643049056, 656.6802299060287),
                (319.11327280011943, 657.5745582827944),
                (310.24090109157095, 651.3492613695286),
                (301.304460216266, 652.4086196574938),
                (291.89747386770466, 656.9713570170311),
                (283.101978948757, 651.5394527353086),
                (274.0286959721896, 655.3733448466576),
                (265.2245525205608, 653.7354247904262),
                (256.02388052580665, 651.5567336092613),
                (246.0560625867149, 653.5236505214285),
                (237.67439191679063, 652.4490380497921),
                (227.86297616855512, 656.9797254643768),
                (218.7386442890337, 655.0571931344848),
                (209.29493836925306, 657.6296239396756),
                (200.5088348212403, 656.653835390137),
                (190.82531716120982, 659.2061633273668),
                (181.6204344916405, 657.8315894740225),
                (171.7582832421442, 657.4586763699185),
                (164.44605649817362, 653.5116216640304),
                (155.0615267763429, 658.6616668238344),
                (146.1498022536786, 653.1277079791167),
                (135.93093870026763, 657.9454222079034),
                (125.74330028912543, 661.0235402136996),
                (117.95852962552566, 657.8218692871078),
                (107.67971883219019, 658.5371773307428),
                (97.62311939513262, 658.5878794391443),
                (87.68723115975311, 660.1286820232262),
                (78.6479916081404, 657.3712593557153),
                (69.61387029632299, 659.7328834532157),
                (60.67698773912997, 659.32301226087),
                (60.787716971838925, 648.9526284156917),
                (59.727758215667315, 640.351346854622),
                (59.58777749423901, 631.8763388834551),
                (58.573166258997894, 622.2564619101129),
                (63.36836722218892, 611.7501433221606),
                (61.74841613351377, 603.4666948179054),
                (63.71478226104162, 593.0458294001091),
                (58.954435712348, 585.5933108420007),
                (61.43332780352294, 575.5861171363049),
                (59.29341119349235, 566.5404038962812),
                (62.69647925510681, 556.1507217813921),
                (62.701633129791546, 547.341320095646),
                (64.30090714083421, 538.6653542931126),
                (65.13103948037113, 529.3768887115383),
                (64.32611865981623, 520.3649329887131),
                (62.030878258016756, 510.0771899111275),
                (63.30177081458582, 501.8805006042278),
                (63.39678338661656, 492.5326370262796),
                (65.43504724782603, 482.0397789081357),
                (63.584307652299586, 473.82012794449537),
                (62.49335720361569, 464.29876767786686),
                (66.88959520615005, 455.39146014152686),
                (62.262351270489745, 446.44822802804345),
                (66.33789613693699, 437.26551008425196),
                (65.9444992988602, 427.8067153232147),
                (63.266009404016145, 418.8869644955276),
                (67.61132335718388, 409.8966716654814),
                (65.04758904722928, 400.7403560296875),
                (64.23413582880426, 391.7134535898836),
                (66.10778940721129, 382.5863886523213),
                (63.20957379743454, 373.6600540738026),
                (67.34854876270305, 364.5004689032517),
                (63.7633940346354, 355.4788131827244),
                (65.10338589741053, 346.34441266325234),
                (70.06971235275785, 337.532919366369),
                (64.29451659434255, 328.2969569120089),
                (63.97097460290135, 319.0351843249688),
                (62.88377980156981, 309.8713310108283),
                (62.243273032365096, 300.905641834637),
                (68.14073556299874, 292.0200077142913),
                (65.35574613903452, 283.20874866536576),
                (68.09668704245195, 274.3422358439371),
                (66.91660066077684, 264.8947122674031),
                (66.70794126883068, 255.81528130853775),
                (63.58353483048986, 246.4646949187968),
                (67.37834225782008, 238.0822121030751),
                (61.75075433843149, 227.84196472448278),
                (62.9536555689489, 218.59161699730612),
                (61.59462325655135, 208.87764433173774),
                (63.10420120658692, 200.34998030684224),
                (65.40972728046252, 191.1159020727746),
                (66.11818450529896, 183.1046262219428),
                (60.62334544985422, 172.00048486205432),
                (64.10755361889778, 164.14045002652426),
                (58.770018620560265, 153.19127706430373),
                (60.566795680639906, 145.52905513952263),
                (59.09843439917977, 134.4862648245718),
                (64.04201336393922, 126.06376331591805),
                (63.88624148456045, 117.88383275517481),
                (61.1271311223233, 107.50497550126835),
                (64.7835053005014, 98.78563377556095),
                (62.64772248121625, 89.8709244045524),
                (60.21874012821671, 78.73866211272907),
                (58.15671078366296, 68.80183208418401)
            ],
            "rivers": [
                River(*([(0.5000076295109483, 469.11653315022505), (15.078355077439536, 447.85058365758755),
                         (36.81306172274357, 434.00662241550316), (63.07908751049058, 437.0847943846799),
                         (86.47006942854964, 424.75648126955065), (111.56420233463035, 419.81890592813),
                         (134.51767757686733, 408.5531090257115), (159.61181048294804, 413.11567864499887),
                         (182.40903334096285, 416.6001068131533), (204.09686427100024, 407.5530937666895),
                         (229.9566338597696, 408.9437399862669), (254.7538872358282, 406.28744945448994),
                         (278.488624399176, 413.91256580453194), (304.2858930342565, 414.0531929503319),
                         (329.8019073777371, 410.2093842984665), (348.36469062333106, 392.3653620202945),
                         (364.8024414435035, 372.5213092240787), (385.66213473716334, 359.3961089494163),
                         (408.1312275883116, 349.25532921339743), (428.2096589608606, 334.94261081864653),
                         (446.225558861677, 318.1298542763409), (473.788479438468, 317.129839017319),
                         (494.91380178530557, 307.42656595712214), (516.7110093842984, 314.8173037308309),
                         (544.0708018616007, 314.16104371709775), (569.1961852445259, 321.39552910658426),
                         (594.2278171969177, 313.80166323338676), (618.8844434271763, 304.0983901731899),
                         (635.5721980621042, 288.2543984130617), (657.7444113832304, 286.5668726634623),
                         (681.8854047455558, 277.4261081864652), (694.7918516823072, 254.4101319905394),
                         (719.4953536278324, 245.11311512932022)], 8, 0, [], Rect(Point(0, 0), Point(720, 720))))
            ]
        }
        print()


class DummyState:
    def __init__(self):
        self.map = DummyMap()


class DummyView(gui.UIInteractiveWidget):
    def __init__(self, x=0, y=0,
                 width: float = 1500,
                 height: float = 900, ):
        super().__init__(x, y, width, height)

        self.state = DummyState()
        self.ground = Ground()
        self.first_frame = True

    def do_render(self, surface):
        if self.first_frame:
            self.ground.first_frame(self.state)
            self.first_frame = False

        self.prepare_render(surface)
        surface.activate()
        surface.clear((127, 127, 127, 255))
        self.ground.render(self.state, surface, 1)


class GroundTestWindow(arcade.Window):
    from arcade import gui

    def __init__(self):
        super().__init__(1600, 1000, "Ground Test window")

        self.manager = gui.UIManager()
        self.manager.enable()
        self.v_box = gui.UIBoxLayout()

        self.d_view = DummyView()
        self.v_box.add(self.d_view)

        self.manager.add(gui.UIAnchorWidget(anchor_x="center_x", anchor_y="center_y", child=self.v_box))

    def on_draw(self):
        arcade.start_render()
        self.manager.draw()


if __name__ == '__main__':
    window = GroundTestWindow()
    arcade.run()
